<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/dd61417c3c.js" crossorigin="anonymous"></script>
    <title id="title">DASHBOARD</title>
</head>
<body>
    <section class="wrapper d-flex flex-row">
        <nav class="vh-100">
            <div class="pt-5">
                <div id="profilePic" class="text-center m-auto p-auto border rounded-circle">
                    <img class="img-fluid w-75" src="admin.png" alt="">
                </div>
            </div>
            <div class="m-5">
                <h2 class="text-white text-center">ADMINISTRATIVE</h2>
            </div>
            <div class="navBar">
                <li>
                    <button id="dbBtn" class="fs-4 h-100 w-100" onclick="dashBoard()">
                        <i class="fa-solid fa-chart-line pe-2 text-center"></i>
                        <span class="fs-4 me-5">
                            Dashboard
                        </span>
                    </button>
                </li>
                <li>
                    <button id="regStudentBtn" class="fs-4 h-100 w-100" onclick="registerStudent()">
                        <i class="fa-solid fa-user-plus ms-1 text-end"></i>
                        <span class="fs-4 ms-2">
                            Register Student
                        </span>
                    </button>
                </li>
                <li>
                    <button id="profileBtn" class="fs-4 h-100 w-100" onclick="profile()">
                        <i class="fa-solid fa-address-card pe-2 text-center"></i>
                        <span class="fs-4 me-5 pe-5">
                            Profile
                        </span>
                    </button>
                </li>
            </div>
            <div id="logoutDiv">
                <button id="logoutBtn" class="fs-4 h-100 w-100">
                    <i class="fa-solid fa-arrow-right-from-bracket text-center"></i>
                    <span class="fs-4 me-5 pe-4">
                        Log Out
                    </span>
                </button>
            </div>
        </nav>

        <!-- Dashboard Content -->
        <div id="db" style="min-height: 823.3px;" class="container shadow-lg">
            <div class="db">
                <div class="mb-2">
                    <h2 class="fs-1 fw-bold">My Dashboard</h2>
                </div>
                <div class="row">
                    <div class="first card p-5 col me-5">
                        <div class="m-3 h-75">
                            <h2 class="text-white">Total Boys</h2>
                        </div>
                        <div class="card-body">
                            <span id="totalBoys" class="text-white">0</span>
                        </div>
                    </div>
                    <div class="second card p-5 col">
                        <div class="m-3 h-75">
                            <h2 class="text-white">Total Girls</h2>
                        </div>
                        <div class="card-body">
                            <span id="totalGirls" class="text-white">0</span>
                        </div>
                    </div>
                    <div class="third card p-5 col ms-5">
                        <div class="m-3 h-75">
                            <h2 class="text-white">Total Students</h2>
                        </div>
                        <div class="card-body">
                            <span id="totalStudents" class="text-white">0</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-5">
                <h2>Students List:</h2>
                <table class="table table-striped border border-2">
                    <thead>
                        <tr>
                            <th class="table-name border">Name</th>
                            <th class="table-age border">Age</th>
                            <th class="table-gender border">Gender</th>
                            <th class="table-contactNumber border">Contact No.</th>
                            <th class="table-address border">Address</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Register Student Content -->
        <div id="regStudent" class="container shadow-lg">
            <div class="d-flex">
                <div id="regStudentContainer">
                    <div class="mb-5">
                        <h1>Register Student</h1>
                    </div>
                    <div class="row mb-5">
                        <div class="col">
                            <h4>First Name <span class="required fs-3">*</span></h4>
                            <input id="firstname" class="fs-3 px-2" type="text">
                        </div>
                        <div class="col">
                            <h4>Last Name <span class="required fs-3">*</span></h4>
                            <input id="lastname" class="fs-3 px-2" type="text">
                        </div>
                    </div>
                    <div class="row mb-5">
                        <div class="col">
                            <h4>Age <span class="required fs-3">*</span></h4>
                            <input id="age" class="fs-3 px-2" type="number">
                        </div>
                        <div class="col">
                            <h4>Gender <span class="required fs-3">*</span></h4>
                            <select id="gender" name="gender" class="fs-3 px-2">
                                <option selected disabled hidden>Choose a gender . . .</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                        </div>
                        <div class="col">
                            <h4>Contact Number <span class="required fs-3">*</span> <span id="numberExist" class="fs-3 text-danger fw-bold"></span></h4>
                            <input id="contactNo" class="fs-3 px-2" type="number">
                        </div>
                    </div>
                    <div class="mb-4">
                        <h4>Address <span class="required fs-3">*</span></h4>
                        <textarea name="address" id="address" class="fs-3 px-2 w-100" cols="30" rows="10"></textarea>
                    </div>
                    <div class="row">
                        <div class="me-2">
                            <button id="submitStudentBtn" class="rounded-2" onclick="submitStudent()" disabled>Submit</button>
                        </div>
                        <div class="ms-2">
                            <button id="clearBtn" class="rounded-2" onclick="clr()">Clear</button>
                        </div>
                    </div>
                </div>
                <div id="studentId" class="w-25">
                    <div class="d-flex flex-nowrap justify-content-end align-items-center h-100">
                        <div class="padding">
                            <div class="font">
                                <div class="top">
                                    <img id="idPic" src="female.png">
                                </div>
                                <div class="bottom">
                                    <p class="mb-0"><span id="idFirstName" class="fs-3"></span> <span id="idLastName" class="fs-3"></span></p>
                                    <p class="fs-6">ID No. <span id="idNumber" class="fs-6">0000</span></p>
                                    <div class="barcode">
                                        <img src="qr.png">
                                    </div>
                                    <div class="mt-3">
                                        <p id="phoneNumber" class="no"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Content -->
        <div id="pf" class="container shadow-lg">
            <div class="mb-5">
                <h1 class="fw-bold text-start">Profile</h1>
            </div>
            <div class="d-flex pt-5">
                <div class="w-50 ms-5">
                    <div class="mb-5">
                        <h4>Username:</h4>
                        <input class="w-50 fs-3 px-2" type="text" value="" disabled>
                    </div>
                    <div class="mb-5">
                        <h4>Email:</h4>
                        <input class="w-50 fs-3 px-2" type="text" value="" disabled>
                    </div>
                    <div class="mb-4 pt-5">
                        <h2>Change Password:</h2>
                    </div>
                    <div class="mb-5">
                        <h4>Current Password:</h4>
                        <input id="oldPassword" class="w-50 fs-3 px-2" type="password" value="******">
                    </div>
                    <div class="mb-5">
                        <h4>New Password:</h4>
                        <input id="newPassword" class="w-50 fs-3 px-2" type="password" value="">
                    </div>
                    <div class="mb-4">
                        <h4>Confirm Password:</h4>
                        <input id="newCPassword" class="w-50 fs-3 px-2" type="password" value="">
                    </div>
                    <button id="updateProfile" class="rounded-2 me-3" disabled>Update</button>
                    <button id="cancelProfile" class="rounded-2" onclick="cancel()">Cancel</button>
                </div>
                <div class="w-50">
                    <img class="img-fluid" src="49.png" alt="">
                </div>
            </div>
        </div>
    </section>
    
<script>
    const title = document.getElementById("title")
    const db = document.getElementById("db")
    const regStudent = document.getElementById("regStudent")
    const dbBtn = document.getElementById("dbBtn")
    const regStudentBtn = document.getElementById("regStudentBtn")
    const pf = document.getElementById("pf")
    const profileBtn = document.getElementById("profileBtn")
    const submitStudentBtn = document.getElementById('submitStudentBtn')
    const firstName = document.getElementById('firstname')
    const lastName = document.getElementById('lastname')
    const age = document.getElementById('age')
    const gender = document.getElementById('gender')
    const contactNo = document.getElementById('contactNo')
    const address = document.getElementById('address')
    const oldPassword = document.getElementById('oldPassword')
    const newPassword = document.getElementById('newPassword')
    const newCPassword = document.getElementById('newCPassword')
    const updateProfile = document.getElementById('updateProfile')
    const cancelProfile = document.getElementById('updateProfile')

    function validatePass() {
        if (oldPassword.value !== '' && newPassword.value !== '' && newCPassword.value !== '') {
            if (newPassword.value === newCPassword.value) {
                updateProfile.disabled = false
                updateProfile.style.backgroundColor = '#54b7c0'
                updateProfile.style.color = 'black'
                updateProfile.style.fontWeight = 'bold'
                updateProfile.style.border = '#7ec9cf 1px solid'
                updateProfile.style.boxShadow = '#6ef3ff 0px 0px 10px 0px'
                updateProfile.style.cursor = 'pointer'
            } else {
                updateProfile.disabled = true
                updateProfile.style.backgroundColor = '#b3e0e4'
                updateProfile.style.color = '#8b8b8b'
                updateProfile.style.fontWeight = 'none'
                updateProfile.style.border = '#addee0 1px solid'
                updateProfile.style.removeProperty('box-shadow')
                updateProfile.style.cursor = 'not-allowed'
            }
        } else {
            updateProfile.disabled = true
            updateProfile.style.backgroundColor = '#b3e0e4'
            updateProfile.style.color = '#8b8b8b'
            updateProfile.style.fontWeight = 'none'
            updateProfile.style.border = '#addee0 1px solid'
            updateProfile.style.removeProperty('box-shadow')
            updateProfile.style.cursor = 'not-allowed'
        }
    }

    oldPassword.addEventListener('keyup', validatePass)
    newPassword.addEventListener('keyup', validatePass)
    newCPassword.addEventListener('keyup', validatePass)

    function cancel() {
        oldPassword.value = ''
        newPassword.value = ''
        newCPassword.value = ''
        updateProfile.disabled = true
        updateProfile.style.backgroundColor = '#b3e0e4'
        updateProfile.style.color = '#8b8b8b'
        updateProfile.style.fontWeight = 'none'
        updateProfile.style.border = '#addee0 1px solid'
        updateProfile.style.removeProperty('box-shadow')
        updateProfile.style.cursor = 'not-allowed'
    }

    function registerStudent() {
        title.innerHTML = 'REGISTER STUDENT'
        db.style.display = "none"
        pf.style.display = "none"
        regStudent.style.display = "block"
        regStudentBtn.style.backgroundColor = "#454a61"
        regStudentBtn.style.color = "white"
        dbBtn.style.backgroundColor = "#181e36"
        dbBtn.style.color = "rgb(161, 161, 161)"
        profileBtn.style.backgroundColor = "#181e36"
        profileBtn.style.color = "rgb(161, 161, 161)"
    }

    function dashBoard() {
        title.innerHTML = 'DASHBOARD'
        db.style.display = "block"
        regStudent.style.display = "none"
        pf.style.display = "none"
        dbBtn.style.backgroundColor = "#454a61"
        dbBtn.style.color = "white"
        regStudentBtn.style.backgroundColor = "#181e36"
        regStudentBtn.style.color = "rgb(161, 161, 161)"
        profileBtn.style.backgroundColor = "#181e36"
        profileBtn.style.color = "rgb(161, 161, 161)"

        fetch('http://localhost:3000/totalboys', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({})
        }).then((data) => {
            return data.json()
        }).then((data) => {
            totalBoys.innerHTML = data.TotalBoys
        })

        fetch('http://localhost:3000/totalgirls', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({})
        }).then((data) => {
            return data.json()
        }).then((data) => {
            totalGirls.innerHTML = data.TotalGirls
        })

        fetch('http://localhost:3000/totalstudents', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({})
        }).then((data) => {
            return data.json()
        }).then((data) => {
            console.log(data)
            totalStudents.innerHTML = data.TotalStudents
        })
    }

    function profile() {
        title.innerHTML = 'PROFILE'
        profileBtn.style.backgroundColor = "#454a61"
        profileBtn.style.color = "white"
        pf.style.display = "block"
        db.style.display = "none"
        regStudent.style.display = "none"
        dbBtn.style.backgroundColor = "#181e36"
        dbBtn.style.color = "rgb(161, 161, 161)"
        regStudentBtn.style.backgroundColor = "#181e36"
        regStudentBtn.style.color = "rgb(161, 161, 161)"
    }

    function submitStudent() {
        const firstname = document.getElementById('firstname')
        const lastname = document.getElementById('lastname')
        const age = document.getElementById('age')
        const gender = document.getElementById('gender')
        const contactNo = document.getElementById('contactNo')
        const address = document.getElementById('address')

        fetch('http://localhost:3000/students' , {
            method: 'post',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                firstname: firstName.value,
                lastname: lastName.value,
                age: age.value,
                gender: gender.value,
                contactnumber: contactNo.value,
                address: address.value
            })
        }).then((studentData) => {
            return studentData.json()
        }).then((studentData) => {
            const regStudentContainer = document.getElementById('regStudentContainer')
            const studentId = document.getElementById('studentId')
            const idFirstName = document.getElementById('idFirstName')
            const idLastName = document.getElementById('idLastName')
            const idNumber = document.getElementById('idNumber')
            const phoneNumber = document.getElementById('phoneNumber')
            const numberExist = document.getElementById('numberExist')
            const idPic = document.getElementById('idPic')
            
            if (studentData.success) {
                if (gender.value == 'Male') {
                    idPic.src = 'male.png'
                } else {
                    idPic.src = 'female.png'
                }
                regStudentContainer.style.width = '75%'
                setTimeout(() => {
                    studentId.style.display = 'block'
                }, 1000);

                const tableBody = document.getElementById('studentsTableBody');
                const newRow = tableBody.insertRow(-1);

                const cell1 = newRow.insertCell(0);
                const cell2 = newRow.insertCell(1);
                const cell3 = newRow.insertCell(2);
                const cell4 = newRow.insertCell(3);
                const cell5 = newRow.insertCell(4);

                cell1.textContent = firstName.value + ' ' + lastName.value;
                cell2.textContent = age.value;
                cell3.textContent = gender.value;
                cell4.textContent = contactNo.value;
                cell5.textContent = address.value;
                
                idFirstName.innerHTML = firstName.value
                idLastName.innerHTML = lastName.value
                phoneNumber.innerHTML = contactNo.value
                numberExist.innerHTML = ''
                contactNo.style.boxShadow = 'none';
                contactNo.style.border = "1px solid black"
                fetch('http://localhost:3000/validation' , {
                    method: 'post',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contactnumber: contactNo.value
                    })
                }).then((id) => {
                    return id.json()
                }).then((id) => {
                    console.log(id.idresult)
                    idNumber.innerHTML = id.idresult
                })
            } else {
                regStudentContainer.style.width = '100%'
                contactNo.style.animation = 'shake1 0.5s'
                contactNo.style.boxShadow = 'red 0px 0px 10px 0px';
                contactNo.style.border = "2px solid red"
                numberExist.innerHTML = 'Already Exists'
                setTimeout(function() {
                    contactNo.style.removeProperty('animation')
                }, 500)
                studentId.style.display = 'none'
            }
        })
    }
    

    function studentForm() {
        if (firstName.value !== '' && lastName.value !== '' && age.value !== '' && gender.value !== '' && contactNo.value !== '' && address.value !== '' ) {
            if (gender.value === 'Male' || gender.value === 'Female') {
                submitStudentBtn.disabled = false
                submitStudentBtn.style.backgroundColor = '#54b7c0'
                submitStudentBtn.style.color = 'black'
                submitStudentBtn.style.fontWeight = 'bold'
                submitStudentBtn.style.border = '#7ec9cf 1px solid'
                submitStudentBtn.style.boxShadow = '#6ef3ff 0px 0px 10px 0px'
                submitStudentBtn.style.cursor = 'pointer'
            } else {
                submitStudentBtn.style.backgroundColor = '#b3e0e4'
                submitStudentBtn.style.color = '#8b8b8b'
                submitStudentBtn.style.cursor = 'not-allowed'
                submitStudentBtn.style.border = '#addee0 1px solid'
                submitStudentBtn.style.boxShadow = 'none' 
            }    
        } else {
            submitStudentBtn.style.backgroundColor = '#b3e0e4'
            submitStudentBtn.style.color = '#8b8b8b'
            submitStudentBtn.style.cursor = 'not-allowed'
            submitStudentBtn.style.border = '#addee0 1px solid'
            submitStudentBtn.style.boxShadow = 'none'
        }
    }

    firstName.addEventListener('keyup', studentForm)
    lastName.addEventListener('keyup', studentForm)
    age.addEventListener('keyup', studentForm)
    gender.addEventListener('keyup', studentForm)
    contactNo.addEventListener('keyup', studentForm)
    address.addEventListener('keyup', studentForm)

    function clr() {
        const regStudentContainer = document.getElementById('regStudentContainer')
        const studentId = document.getElementById('studentId')
        const numberExist = document.getElementById('numberExist')

        firstName.value = ''
        lastName.value = ''
        age.value = ''
        gender.value = 'Choose a gender . . .'
        contactNo.value = ''
        address.value = ''
        submitStudentBtn.style.backgroundColor = '#b3e0e4'
        submitStudentBtn.style.color = '#8b8b8b'
        submitStudentBtn.style.cursor = 'not-allowed'
        submitStudentBtn.style.border = '#addee0 1px solid'
        submitStudentBtn.style.boxShadow = 'none'
        regStudentContainer.style.width = '100%'
        studentId.style.display = 'none'
        numberExist.innerHTML = ''
        contactNo.style.boxShadow = 'none';
        contactNo.style.border = "1px solid black"
    }

    const totalBoys = document.getElementById('totalBoys') 
    const totalGirls = document.getElementById('totalGirls') 
    const totalStudents = document.getElementById('totalStudents') 
    
    fetch('http://localhost:3000/totalboys', {
        method: 'POST', // Use uppercase 'POST'
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        body: JSON.stringify({}) // Convert the body to JSON
    }).then((data) => {
        return data.json()
    }).then((data) => {
        totalBoys.innerHTML = data.TotalBoys
    })

    fetch('http://localhost:3000/totalgirls', {
        method: 'POST', // Use uppercase 'POST'
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        body: JSON.stringify({}) // Convert the body to JSON
    }).then((data) => {
        return data.json()
    }).then((data) => {
        totalGirls.innerHTML = data.TotalGirls
    })

    fetch('http://localhost:3000/totalstudents', {
        method: 'POST', // Use uppercase 'POST'
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        body: JSON.stringify({}) // Convert the body to JSON
    }).then((data) => {
        return data.json()
    }).then((data) => {
        totalStudents.innerHTML = data.TotalStudents
    })
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>